<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
    <title>Insert title here</title>
    <link href="style.css" rel="stylesheet" type="text/css">
    <script type="text/javascript" src="jquery-1.8.2.min.js"></script>
    <script>
        $(document).ready(function () {

            if (localStorage.getItem('Username') != "" && localStorage.getItem('Password') != "") {
                login(localStorage.getItem('Username'), localStorage.getItem('Password'));
            }
		
		  $('#loginButton').click(function () {
                var uName = $('#username').val();
                var Password = $('#password').val();
				login(uName,Password);
            });
			
			function login(username,password) {
			    var player = new Object();
                player['username'] = username;
                player['password'] = password;

                var jsonString = JSON.stringify(player);
                $.ajax({
                    type: 'POST',
                    url: 'api/login',
                    dataType: 'json',
                    contentType: 'application/json; charset=utf-8',
                    data: jsonString,
                    success: function (result) {
                        localStorage.setItem('Username', result.username);
                        localStorage.setItem('Password', result.password);
                        localStorage.setItem('accessToken', result.accessToken);
                        $('#userlogin').html("<a id=\"logoutLink\" onClick=\"logout();\" href=\"#\">Logout</a>");
                        downloadBettingTable();
                    },
                    error: function (result, ajaxOptions, thrownError) {
                        alert("Errormessage: " + result.status);
                        alert(thrownError);
                    }
                });
			}

            $('#accessButton').click(function () {
                alert(localStorage.getItem('accessToken'));
            });

            function downloadBettingTable() {
                $.get('bord.html', function (data) {
                    $('#contentDiv').html(data);
                });
                $.get('inzetTafel.html', function (data) {
                    $('#bettingTable').html(data);
                });
            }

        });


        function logout() {
            localStorage.clear();
            window.location.reload();
            $('#userlogin').html("<a id=\"loginLink\"  href=\"#\">Login</a>");
        }
    </script>
</head>
<body>
    <header>The Roulette Casino</header>
    <menu>
        <ul>
            <li id="userlogin"><a id="loginLink" href="#">Login</a></li>
            <li>Choose table</li>
            <li>Manage account</li>
        </ul>
    </menu>
    <div id="contentDiv">
        <input type="text" id="username" />
        <input type="text" id="password" />
        <button id="loginButton">Login</button>
        <button id="accessButton">Get AccessToken</button>
    </div>
    <div id="bettingTable">
    </div>
</body>
</html>